{{ define "order_list" }}


<div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
    <h1 class="text-4xl font-extrabold text-gray-900 mb-8 text-center lg:text-left">
        ðŸ“¦ Daftar Pesanan Saya
    </h1>

    {{ if .Message }}
    <div id="flash-message" class="max-w-7xl mx-auto mt-4 px-4 sm:px-6 lg:px-8 animate-fade-in-down">
        <div class="mb-4 p-4 rounded-lg relative flex items-center justify-between shadow-sm
                {{ if eq .MessageStatus "success" }} bg-green-50 border border-green-300 text-green-800
                {{ else if eq .MessageStatus "error" }} bg-red-50 border border-red-300 text-red-800
                {{ else if eq .MessageStatus "warning" }} bg-yellow-50 border border-yellow-300 text-yellow-800
                {{ else }} bg-blue-50 border border-blue-300 text-blue-800
                {{ end }}">
            <span>{{ .Message }}</span>
            <button type="button" class="ml-4 text-gray-700 hover:text-gray-900 focus:outline-none" onclick="this.parentElement.remove()">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>
    {{ end }}

    <div class="space-y-6">
        {{ if .Orders }}
            {{ range .Orders }}
            <div class="bg-white shadow-lg rounded-lg p-6 border border-gray-100 animate-fade-in-up">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 border-b pb-4">
                    <div class="mb-2 md:mb-0">
                        <h2 class="text-xl font-bold text-gray-800">Pesanan #{{ .OrderCode }}</h2>
                        <p class="text-sm text-gray-500">Tanggal Pesan: {{ .CreatedAt.Format "02 Jan 2006, 15:04" }}</p>
                    </div>
                    <div class="flex flex-wrap gap-2 items-center">
                        <span class="font-semibold px-3 py-1 rounded-full text-sm
                            {{ if eq (.Status | orderStatusText) "Selesai" }} bg-green-100 text-green-800
                            {{ else if eq (.Status | orderStatusText) "Dalam Pengiriman" }} bg-blue-100 text-blue-800
                            {{ else if eq (.Status | orderStatusText) "Sedang Diproses" }} bg-indigo-100 text-indigo-800
                            {{ else if eq (.Status | orderStatusText) "Menunggu Pembayaran" }} bg-yellow-100 text-yellow-800
                            {{ else if eq (.Status | orderStatusText) "Dibatalkan" }} bg-red-100 text-red-800
                            {{ else if eq (.Status | orderStatusText) "Gagal" }} bg-red-100 text-red-800
                            {{ else }} bg-gray-100 text-gray-800
                            {{ end }}">
                            Status Pesanan: {{ orderStatusText .Status }}
                        </span>
                        <span class="font-semibold px-3 py-1 rounded-full text-sm
                            {{ if eq (.PaymentStatus | paymentStatusText) "Lunas" }} bg-green-100 text-green-800
                            {{ else if eq (.PaymentStatus | paymentStatusText) "Menunggu Pembayaran" }} bg-yellow-100 text-yellow-800
                            {{ else if eq (.PaymentStatus | paymentStatusText) "Gagal" }} bg-red-100 text-red-800
                            {{ else }} bg-gray-100 text-gray-800
                            {{ end }}">
                            Pembayaran: {{ paymentStatusText .PaymentStatus }}
                        </span>
                    </div>
                </div>
                
                <div class="mb-4">
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">Item Pesanan:</h3>
                    <div class="space-y-3">
                        {{ if .OrderItems }}
                            {{ range .OrderItems }}
                            <div class="flex items-center text-gray-600">
                                {{ $imageURL := "https://placehold.co/60x60/E0E0E0/333333?text=Img" }}
                                {{ if .Product.ProductImages }}
                                    {{ range $index, $image := .Product.ProductImages }}
                                        {{ if eq $index 0 }}
                                            {{ $imageURL = $image.Path }}
                                        {{ end }}
                                    {{ end }}
                                {{ end }}
                                <img src="{{ $imageURL }}" alt="{{ .ProductName }}" class="w-16 h-16 object-cover rounded-md mr-4 border border-gray-200">
                                <div class="flex-1">
                                    <p class="font-medium">{{ .ProductName }}</p>
                                    <p class="text-sm">{{ .Qty }} x {{ rupiah .Price }}</p>
                                </div>
                                <p class="font-semibold">{{ rupiah .BaseTotal }}</p> 
                            </div>
                            {{ end }}
                        {{ else }}
                            <p class="text-gray-500 text-sm">Tidak ada item dalam pesanan ini.</p>
                        {{ end }}
                    </div>
                </div>

                <div class="flex justify-between items-center text-lg font-bold text-gray-900 border-t pt-4">
                    <span>Total:</span>
                    <span class="text-emerald-700">{{ rupiah .GrandTotal }}</span>
                </div>
                <div class="mt-4 text-right">
                    <a href="/orders/{{ .OrderCode }}" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Lihat Detail
                    </a>
                </div>
            </div>
            {{ end }}
        {{ else }}
            <div class="bg-white shadow-lg rounded-lg p-6 border border-gray-100 text-center">
                <p class="text-xl text-gray-600">Anda belum memiliki pesanan.</p>
                <div class="mt-6">
                    <a href="/products" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 transition duration-200">
                        <i class="fas fa-shopping-bag mr-2"></i> Mulai Belanja Sekarang!
                    </a>
                </div>
            </div>
        {{ end }}
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const flashMessage = document.getElementById('flash-message');
        if (flashMessage) {
            setTimeout(() => {
                flashMessage.classList.add('animate-fade-out');
                flashMessage.addEventListener('animationend', () => {
                    flashMessage.remove();
                });
            }, 5000); // Pesan akan hilang setelah 5 detik
        }
    });
</script>

{{ end }}
